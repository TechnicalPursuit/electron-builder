{"version":3,"file":"configurationValidationTest.js","sourceRoot":"","sources":["../src/configurationValidationTest.ts"],"names":[],"mappings":";;AAAA,8DAA0D;AAC1D,uDAA0D;AAC1D,4DAAgE;AAChE,0DAA+G;AAC/G,qDAAqE;AAErE,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,YAAY,EAAE,sBAAS,CAAC;IAChD,OAAO,EAAE,2BAAc;IACvB,MAAM,EAAE;QACN,GAAG,EAAE,GAAG;QACR,GAAG,EAAE;YACH,GAAG,EAAE,KAAK;SACX;KACK;CACT,EAAE,SAAS,EAAE,KAAK,CAAC,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,QAAQ,CAAC,6CAA6C,CAAC,CAAC,CAAC,CAAA;AAE9F,IAAI,CAAC,IAAI,CAAC,cAAc,CAAC,iBAAiB,EAAE,sBAAS,CAAC;IACpD,OAAO,EAAE,2BAAc;IACvB,MAAM,EAAE;QACN,KAAK,EAAE,EAAE;KACH;CACT,CAAC,CAAC,CAAA;AAEH,oEAAoE;AACpE,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,YAAY,EAAE,gBAAG,CAAC;IAC1C,OAAO,EAAE,2BAAQ,CAAC,KAAK,CAAC,YAAY,CAAC,UAAU,CAAC;IAChD,MAAM,EAAE;QACN,KAAK,EAAE;YACL,MAAM,EAAE,UAAU;SACnB;QACD,UAAU,EAAE;YACV,WAAW;YACX,mBAAmB;YACnB;gBACE,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,GAAG;gBACP,MAAM,EAAE;oBACN,OAAO;iBACR;aACF;YACD;gBACE,IAAI,EAAE,MAAM;gBACZ,EAAE,EAAE,GAAG;gBACP,MAAM,EAAE;oBACN,OAAO;iBACR;aACF;YACD,wBAAwB;YACxB;gBACE,IAAI,EAAE,UAAU;gBAChB,EAAE,EAAE,GAAG;aACR;SACF;KACF;CACF,CAAC,CAAC,CAAA;AAEH,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,OAAO,EAAE,GAAG,EAAE;IACtC,OAAO,uBAAc,CAAC;QACpB,KAAK,EAAE,mBAAmB;QAC1B,KAAK,EAAE,CAAC,EAAC,IAAI,EAAE,UAAU,EAAE,EAAE,EAAE,KAAK,EAAE,MAAM,EAAE,MAAM,EAAC,CAAC;QACtD,GAAG,EAAE;YACH,MAAM,EAAE,MAAM;YACd,IAAI,EAAE,gBAAgB;SACvB;KACF,EAAE,IAAI,yBAAW,EAAE,CAAC,CAAA;AACvB,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,KAAK,CAAC,cAAc,CAAC,qBAAqB,EAAE,KAAK,IAAI,EAAE;IAC1D,MAAM,KAAK,GAAG,+BAAqB,CAAC,qBAAW,EAAE,CAAC,CAAA;IAClD,MAAM,OAAO,GAAG,0BAAgB,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC,sBAAsB,EAAE,oCAAoC,CAAC,CAAe,CAAC,CAAA;IAC3H,MAAM,MAAM,GAAG,OAAO,CAAC,MAAuB,CAAA;IAC9C,MAAM,uBAAc,CAAC,MAAM,EAAE,IAAI,yBAAW,EAAE,CAAC,CAAA;IAC/C,MAAM,CAAC,MAAM,CAAC,GAAK,CAAC,QAAQ,CAAC,CAAC,QAAQ,EAAE,CAAA;IACxC,MAAM,CAAC,MAAM,CAAC,GAAK,CAAC,eAAe,CAAC,CAAC,IAAI,CAAC,KAAK,CAAC,CAAA;AAClD,CAAC,CAAC,CAAA","sourcesContent":["import { DebugLogger } from \"builder-util/out/DebugLogger\"\nimport { Configuration, Platform } from \"electron-builder\"\nimport { validateConfig } from \"app-builder-lib/out/util/config\"\nimport { createYargs, configureBuildCommand, normalizeOptions, CliOptions } from \"electron-builder/out/builder\"\nimport { app, appThrows, linuxDirTarget } from \"./helpers/packTester\"\n\ntest.ifAll.ifDevOrLinuxCi(\"validation\", appThrows({\n  targets: linuxDirTarget,\n  config: {\n    foo: 123,\n    mac: {\n      foo: 12123,\n    },\n  } as any,\n}, undefined, error => error.message.includes(\"configuration has an unknown property 'foo'\")))\n\ntest.skip.ifDevOrLinuxCi(\"appId as object\", appThrows({\n  targets: linuxDirTarget,\n  config: {\n    appId: {},\n  } as any,\n}))\n\n// https://github.com/electron-userland/electron-builder/issues/1302\ntest.ifAll.ifDevOrLinuxCi(\"extraFiles\", app({\n  targets: Platform.LINUX.createTarget(\"appimage\"),\n  config: {\n    linux: {\n      target: \"zip:ia32\",\n    },\n    extraFiles: [\n      \"lib/*.jar\",\n      \"lib/Proguard/**/*\",\n      {\n        from: \"lib/\",\n        to: \".\",\n        filter: [\n          \"*.dll\"\n        ]\n      },\n      {\n        from: \"lib/\",\n        to: \".\",\n        filter: [\n          \"*.exe\"\n        ]\n      },\n      \"BLClient/BLClient.json\",\n      {\n        from: \"include/\",\n        to: \".\"\n      }\n    ],\n  },\n}))\n\ntest.ifAll.ifDevOrLinuxCi(\"files\", () => {\n  return validateConfig({\n    appId: \"com.example.myapp\",\n    files: [{from: \"dist/app\", to: \"app\", filter: \"*.js\"}],\n    win: {\n      target: \"NSIS\",\n      icon: \"build/icon.ico\"\n    }\n  }, new DebugLogger())\n})\n\ntest.ifAll.ifDevOrLinuxCi(\"null string as null\", async () => {\n  const yargs = configureBuildCommand(createYargs())\n  const options = normalizeOptions(yargs.parse([\"-c.mac.identity=null\", \"--config.mac.hardenedRuntime=false\"]) as CliOptions)\n  const config = options.config as Configuration\n  await validateConfig(config, new DebugLogger())\n  expect(config.mac!!.identity).toBeNull()\n  expect(config.mac!!.hardenedRuntime).toBe(false)\n})"]}